<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Control.Concurrent.TxEvent</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Control-Concurrent-TxEvent.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">tx-events-0.4.1: Transactional Events</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>(c) 2006,2007 Kevin Donnelly &amp; Matthew Fluet; 2011 Edward Amsden &amp; Matthew Fluet</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>Matthew Fluet &lt;Matthew.Fluet@gmail.com&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>non-portable (requires Control.Concurrent and Control.Concurrent.STM)</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Control.Concurrent.TxEvent</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Event type</a></li><li><a href="#g:2">Synchronization</a></li><li><a href="#g:3">Monadic event combinators</a></li><li><a href="#g:4">Exceptions</a></li><li><a href="#g:5">Synchronous channels</a></li><li><a href="#g:6">Time delays</a></li><li><a href="#g:7">Miscellaneous</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Transactional Events.</p><p>This library provides <em>first-class synchronous events</em> in the style
 of CML (<a href="http://cml.cs.uchicago.edu/">http://cml.cs.uchicago.edu/</a>), but generalizes the concept
 to allow <em>multiple</em>, <em>dependent</em> events to be combined in a single
 event.  The semantics of these generalized events ensures an
 <em>all-or-nothing</em> transactional property -- either all of the
 constituent events synchronize or none of them synchronize.  When
 the constituent events include synchronous message passing, the
 semantics ensures that no thread is able to complete its
 synchronization until all of its (transitive) communications
 partners are willing to commit to a compatible synchronization.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Evt">Evt</a> a</li><li class="src short"><a href="#v:sync">sync</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/System-IO.html#t:IO">IO</a> a</li><li class="src short"><a href="#v:alwaysEvt">alwaysEvt</a> :: a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</li><li class="src short"><a href="#v:thenEvt">thenEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; (a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> b) -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> b</li><li class="src short"><a href="#v:neverEvt">neverEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</li><li class="src short"><a href="#v:chooseEvt">chooseEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</li><li class="src short"><a href="#v:throwEvt">throwEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; e -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</li><li class="src short"><a href="#v:catchEvt">catchEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; (e -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a) -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:SChan">SChan</a> a</li><li class="src short"><a href="#v:newSChan">newSChan</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> (<a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a> a)</li><li class="src short"><a href="#v:sendEvt">sendEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a> a -&gt; a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</li><li class="src short"><a href="#v:recvEvt">recvEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a> a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</li><li class="src short"><a href="#v:timeOutEvt">timeOutEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</li><li class="src short"><a href="#v:utcTimeEvt">utcTimeEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/time-1.5.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a> -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</li><li class="src short"><a href="#v:nominalDiffTimeEvt">nominalDiffTimeEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/time-1.5.0.1/Data-Time-Clock.html#t:NominalDiffTime">NominalDiffTime</a> -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</li><li class="src short"><a href="#v:myThreadIdEvt">myThreadIdEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Concurrent.html#t:ThreadId">ThreadId</a></li><li class="src short"><a href="#v:forkEvt">forkEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; (a -&gt; <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/System-IO.html#t:IO">IO</a> ()) -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Concurrent.html#t:ThreadId">ThreadId</a></li></ul></div><div id="interface"><h1 id="g:1">Event type</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Evt" class="def">Evt</a> a</p><div class="doc"><p>A value of type <code><code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> a</code> is an <em>event</em> which, when synchronized upon,
performs some synchronous operations before returning a value of type
<code>a</code>.</p><p>When synchronized upon, the event may perform (tentative) synchronous
message passing, but will exhibit no observable effects (i.e., will
not return) until the event and all communication partners can commit.</p><p><code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> is a monad (with plus), so <code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> actions can be combined using
either the <code>do</code>-notation or the operations from the <code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a></code> and
<code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#t:MonadPlus">MonadPlus</a></code> classes.</p></div><div class="subs instances"><p id="control.i:Evt" class="caption collapser" onclick="toggleSection('i:Evt')">Instances</p><div id="section.i:Evt" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Data-Functor.html#t:Functor">Functor</a> <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Applicative.html#t:Alternative">Alternative</a> <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#t:MonadPlus">MonadPlus</a> <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">Synchronization</h1><div class="top"><p class="src"><a name="v:sync" class="def">sync</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/System-IO.html#t:IO">IO</a> a</p><div class="doc"><p>Synchronize on an event.</p></div></div><h1 id="g:3">Monadic event combinators</h1><div class="top"><p class="src"><a name="v:alwaysEvt" class="def">alwaysEvt</a> :: a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</p><div class="doc"><p>The always commitable event computation; 
the <code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#v:return">return</a></code> of the <code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> monad.</p></div></div><div class="top"><p class="src"><a name="v:thenEvt" class="def">thenEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; (a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> b) -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> b</p><div class="doc"><p>Sequential composition of event computations; 
the <code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#v:-62--62--61-">&gt;&gt;=</a></code> of the <code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> monad.</p></div></div><div class="top"><p class="src"><a name="v:neverEvt" class="def">neverEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</p><div class="doc"><p>The never commitable event computation; 
the <code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#v:mzero">mzero</a></code> of the <code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> monad.</p></div></div><div class="top"><p class="src"><a name="v:chooseEvt" class="def">chooseEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</p><div class="doc"><p>Non-deterministic composition of event compuations;
the <code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Monad.html#v:mplus">mplus</a></code> of the <code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> monad.</p></div></div><h1 id="g:4">Exceptions</h1><div class="top"><p class="src"><a name="v:throwEvt" class="def">throwEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; e -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</p><div class="doc"><p>A variant of <code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Exception-Base.html#v:throw">throw</a></code> that can be used within the <code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> monad.</p></div></div><div class="top"><p class="src"><a name="v:catchEvt" class="def">catchEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; (e -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a) -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</p><div class="doc"><p>Exception handling within the <code><a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a></code> monad.</p></div></div><h1 id="g:5">Synchronous channels</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:SChan" class="def">SChan</a> a</p><div class="doc"><p>A <code><a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a></code> is a synchronous channel, used for communication between
concurrent threads.  Message passing is synchronous: both the sender
and the receiver must be ready to communicate before either can
proceed.</p></div><div class="subs instances"><p id="control.i:SChan" class="caption collapser" onclick="toggleSection('i:SChan')">Instances</p><div id="section.i:SChan" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> (<a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a> a)</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:newSChan" class="def">newSChan</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> (<a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a> a)</p><div class="doc"><p>Create a new synchronous channel.</p></div></div><div class="top"><p class="src"><a name="v:sendEvt" class="def">sendEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a> a -&gt; a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</p><div class="doc"><p>Send a value on the channel.</p></div></div><div class="top"><p class="src"><a name="v:recvEvt" class="def">recvEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:SChan">SChan</a> a -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a</p><div class="doc"><p>Receive a value on the channel.</p></div></div><h1 id="g:6">Time delays</h1><div class="top"><p class="src"><a name="v:timeOutEvt" class="def">timeOutEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</p><div class="doc"><p>Create an event that becomes commitable in the given number of
microseconds after the start of synchronization.  </p></div></div><div class="top"><p class="src"><a name="v:utcTimeEvt" class="def">utcTimeEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/time-1.5.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a> -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</p><div class="doc"><p>Create an event that becomes commitable at the specified time.</p></div></div><div class="top"><p class="src"><a name="v:nominalDiffTimeEvt" class="def">nominalDiffTimeEvt</a> :: <a href="file:///usr/share/doc/ghc-doc/html/libraries/time-1.5.0.1/Data-Time-Clock.html#t:NominalDiffTime">NominalDiffTime</a> -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> ()</p><div class="doc"><p>Create an event that becomes commitable at the specified time interval
after the start of synchronization.</p></div></div><h1 id="g:7">Miscellaneous</h1><div class="top"><p class="src"><a name="v:myThreadIdEvt" class="def">myThreadIdEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Concurrent.html#t:ThreadId">ThreadId</a></p><div class="doc"><p>An always commitable event computation that returns the <code><a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Concurrent.html#t:ThreadId">ThreadId</a></code> of
the synchronizing thread.</p></div></div><div class="top"><p class="src"><a name="v:forkEvt" class="def">forkEvt</a> :: <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> a -&gt; (a -&gt; <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/System-IO.html#t:IO">IO</a> ()) -&gt; <a href="Control-Concurrent-TxEvent.html#t:Evt">Evt</a> <a href="file:///usr/share/doc/ghc-doc/html/libraries/base-4.8.2.0/Control-Concurrent.html#t:ThreadId">ThreadId</a></p><div class="doc"><p><code><code><a href="Control-Concurrent-TxEvent.html#v:forkEvt">forkEvt</a></code> evt f</code> sparks off a new thread to synchronize on <code>evt</code>
(which must synchronize in the same synchronization group as the
parent synchronization); upon successful synchronization (with result
<code>r</code>), the sparked thread acts as <code>f r</code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>